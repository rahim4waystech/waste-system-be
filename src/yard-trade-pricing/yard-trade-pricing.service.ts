
import { YardTradePricing } from "./yard-trade-pricing.entity";
import { Injectable } from "@nestjs/common";
import { InjectRepository } from "@nestjs/typeorm";

import { TypeOrmCrudService } from "@nestjsx/crud-typeorm";

/**
 * This file was generated by Four Ways Technology
 * 
 * On Mon Oct 26 2020 14:25:39 GMT+0000 (Greenwich Mean Time)
 */
@Injectable()
export class YardTradePricingService extends TypeOrmCrudService<YardTradePricing> {
  constructor(@InjectRepository(YardTradePricing) repo) {
    super(repo);
  }

  async deleteAllForYardTrade(yardTradeId) {
    if(!yardTradeId || yardTradeId <= -1) {
      throw new Error("you must provide an valid order id in deleteAllForYardTrade");
    }

    await this.repo.createQueryBuilder()
    .delete()
    .from(YardTradePricing)
    .where("yardTradeId = :id", { id: yardTradeId })
    .execute();
  }

  async getAllPricingForYardTrade(yardTradeId: number=-1) {
    return await this.find({
      where: {
        yardTradeId: yardTradeId,
      },
      relations: ["unit"]
    })
  }
}
